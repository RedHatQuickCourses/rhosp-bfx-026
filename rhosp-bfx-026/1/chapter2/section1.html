<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Guided solution (page 1) :: RHOSP Networking Break-Fix Practice - Resolving &#x27;No Route to Host&#x27; and &#x27;Destination Host Unreachable&#x27; for SSH</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="section2.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">RHOSP Networking Break-Fix Practice - Resolving &#x27;No Route to Host&#x27; and &#x27;Destination Host Unreachable&#x27; for SSH</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rhosp-bfx-026" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">RHOSP Networking Break-Fix Practice - Resolving &#x27;No Route to Host&#x27; and &#x27;Destination Host Unreachable&#x27; for SSH</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Red Hat OpenStack Platform: Break-fix Practice - Resolving No Route to Host and Destination Host Unreachable for SSH</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Whatâ€™s in this break-fix?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Break-fix activity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section2.html">Check your work</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section3.html">Break-fix Scenario</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Guided solution</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section1.html">Guided solution (page 1)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Guided solution (page 2)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RHOSP Networking Break-Fix Practice - Resolving &#x27;No Route to Host&#x27; and &#x27;Destination Host Unreachable&#x27; for SSH</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">RHOSP Networking Break-Fix Practice - Resolving 'No Route to Host' and 'Destination Host Unreachable' for SSH</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">RHOSP Networking Break-Fix Practice - Resolving 'No Route to Host' and 'Destination Host Unreachable' for SSH</a></li>
    <li><a href="index.html">Guided solution</a></li>
    <li><a href="section1.html">Guided solution (page 1)</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Guided solution (page 1)</h1>
<div class="sect1">
<h2 id="_objectives"><a class="anchor" href="#_objectives"></a>Objectives</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Investigate the instance connectivity issue in Red Hat OpenStack Platform.</p>
</li>
<li>
<p>Solve the instance connectivity in the hands-on lab environment.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_outcomes"><a class="anchor" href="#_outcomes"></a>Outcomes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Investigate why ssh to instance is not working.</p>
</li>
<li>
<p>Fix the ssh to instance failing issue.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instructions"><a class="anchor" href="#_instructions"></a>Instructions</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Break the environment if you have not done it and step through the fix.</p>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ lab start bfx026
Running break action against scenario bfx026
Run the following command:
ssh -i /tmp/scenario-bfx026-key.pem cirros@192.168.51.165</pre>
</div>
</div>
</li>
<li>
<p>Run the ssh command from the previous lab command output and notice the No route to host error. Also run the ping command against instance IP.</p>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ ssh -i /tmp/scenario-bfx026-key.pem cirros@192.168.51.165
ssh: connect to host 192.168.51.165 port 22: No route to host

[student@workstation ~]$ ping 192.168.51.165 -c 1
PING 192.168.51.165 (192.168.51.165) 56(84) bytes of data.
From 172.25.250.253 icmp_seq=1 Destination Host Unreachable

--- 192.168.51.165 ping statistics ---
1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms</pre>
</div>
</div>
<div class="paragraph">
<p>You observe that both ssh and ping attempts failed which indicates lack of connectivity.</p>
</div>
</li>
<li>
<p>Because the ping test failed, it is essential to double-check with ARP. Open run tcpdump on one terminal and open a new terminal and ping the IP of the instance.</p>
<div class="paragraph">
<p>Due to the fact that only the <code>utility</code> server has L2 access to the OSP External Network, you have to check ARP on that server.</p>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ ssh lab@utility
Register this system with Red Hat Insights: insights-client --register
Create an account or view all your systems at https://red.ht/insights-dashboard
Last login: Mon Mar 31 06:27:54 2025 from 172.25.250.9
[lab@utility ~]$ sudo -i
[root@utility ~]# ip neighbour | grep 192.168.51.165
192.168.51.165 dev eth2 FAILED

[root@utility ~]# tcpdump -envvi eth2 | grep 192.168.51.165
dropped privs to tcpdump
tcpdump: listening on eth2, link-type EN10MB (Ethernet), snapshot length 262144 bytes
06:16:50.625686 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28
06:16:51.656605 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28
06:16:52.680579 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28</pre>
</div>
</div>
<div class="paragraph">
<p>+
You observe that ARP requests are being sent, but no responses are being received.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use openstackclient POD and check where the VM is running.</p>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ oc exec -n openstack openstackclient -- openstack server list --long
+--------------------------------------+--------------------+--------+------------+-------------+---------------------------------------------------------+---------------------+--------------------------------------+----------+-------------------+---------------------------+------------+-------------+
| ID                                   | Name               | Status | Task State | Power State | Networks                                                | Image Name          | Image ID                             | Flavor   | Availability Zone | Host                      | Properties | Host Status |
+--------------------------------------+--------------------+--------+------------+-------------+---------------------------------------------------------+---------------------+--------------------------------------+----------+-------------------+---------------------------+------------+-------------+
| 410602ae-a400-4358-9723-312c493e409f | scenario-bfx026-vm | ACTIVE | None       | Running     | scenario-bfx026-network=192.168.190.187, 192.168.51.165 | cirros-0.5.2-x86_64 | 10210206-c30a-4765-8547-0dad335b5675 | m1.small | nova              | compute01.srv.example.com |            | UP          |
+--------------------------------------+--------------------+--------+------------+-------------+---------------------------------------------------------+---------------------+--------------------------------------+----------+-------------------+---------------------------+------------+-------------+</pre>
</div>
</div>
<div class="paragraph">
<p>You observe that it is compute01.srv.example.com.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The RHOSP cluster is configured to operate with Distributed Virtual Routing (DVR) functionality. As the DVR is enabled, all Floating IPs are treated as DVR, directing traffic directly to the compute node&#8217;s br-ex interface. This arrangement ensures that traffic bound for the floating IP bypasses the control node entirely.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Identify the network interface used under external bridge br-ex.</p>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ ssh root@compute01.srv.example.com
Activate the web console with: systemctl enable --now cockpit.socket

Register this system with Red Hat Insights: insights-client --register
Create an account or view all your systems at https://red.ht/insights-dashboard
Last login: Wed Apr  2 09:58:41 2025 from 192.168.51.254

[root@compute01 ~]# ovs-vsctl show
...
    Bridge br-ex
        fail_mode: standalone
        Port br-ex
            Interface br-ex
                type: internal
        Port eth2
            Interface eth2
...</pre>
</div>
</div>
</li>
<li>
<p>Verify the ARP requests on the Ethernet device ens4 used under br-ex.</p>
<div class="listingblock">
<div class="content">
<pre>[root@compute01 ~]# tcpdump -envvi eth2 arp
dropped privs to tcpdump
tcpdump: listening on eth2, link-type EN10MB (Ethernet), snapshot length 262144 bytes
10:32:30.176581 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28
10:32:31.176926 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28
10:32:32.200834 52:54:00:02:33:fe &gt; Broadcast, ethertype ARP (0x0806), length 42: Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.51.165 tell 192.168.51.254, length 28
^C
3 packets captured
3 packets received by filter
0 packets dropped by kernel</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ARP requests are being sent but not replied.</p>
</li>
<li>
<p>These should be answered by the router gateway port.</p>
</li>
<li>
<p>The next step is to verify the connectivity from the Metadata namespace by attempting to ping the instance with its fixed IP.</p>
</li>
</ul>
</div>
</li>
<li>
<p>List the floating IP and ensure its alignment with the fixed IP address.</p>
<div class="listingblock">
<div class="content">
<pre>[student@workstation ~]$ oc exec -n openstack openstackclient -- openstack floating ip list
+--------------------------------------+---------------------+------------------+--------------------------------------+--------------------------------------+----------------------------------+
| ID                                   | Floating IP Address | Fixed IP Address | Port                                 | Floating Network                     | Project                          |
+--------------------------------------+---------------------+------------------+--------------------------------------+--------------------------------------+----------------------------------+
| 5a1eb6f3-d643-4169-8deb-e6b2042d9c19 | 192.168.51.165      | 192.168.190.187  | 3abe5cf3-3d40-4c02-af97-59946cfd3951 | ee961465-e812-4563-aaa8-05adb3476889 | 7ac1618d984947c0bfcbf713a94fed4a |
+--------------------------------------+---------------------+------------------+--------------------------------------+--------------------------------------+----------------------------------+</pre>
</div>
</div>
</li>
<li>
<p>Connect to the metadata namespace and ping to instance&#8217;s fixed IP address from there. Run the following command on the compute node.</p>
<div class="listingblock">
<div class="content">
<pre>[root@compute01 ~]# ip netns
ovnmeta-1655a6ba-a91e-4d79-9e2f-ba6d44807c2a (id: 0)

[root@compute01 ~]# ip netns exec ovnmeta-1655a6ba-a91e-4d79-9e2f-ba6d44807c2a ping 192.168.190.187 -c 1
PING 192.168.190.187 (192.168.190.187) 56(84) bytes of data.
64 bytes from 192.168.190.187: icmp_seq=1 ttl=64 time=1.43 ms

--- 192.168.190.187 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.425/1.425/1.425/0.000 ms</pre>
</div>
</div>
<div class="paragraph">
<p>If you get a response, it means that the VM&#8217;s network is functioning correctly locally.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Connectivity works for ICMP from the namespace, which is local to the compute node, but it does not work from the outside. We can try running the OpenFlow protocol trace.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Install the openvswitch-test packages if not already installed.</p>
</li>
</ol>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Guided solution</a></span>
  <span class="next"><a href="section2.html">Guided solution (page 2)</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
